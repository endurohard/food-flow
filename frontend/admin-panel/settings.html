<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ - FoodFlow</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öôÔ∏è</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Navbar */
        .navbar {
            background: #ffffff;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e1e8ed;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .menu-toggle {
            background: none;
            border: none;
            color: #5a6c7d;
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .menu-toggle:hover {
            background: #f5f7fa;
        }

        .nav-brand {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: -280px;
            top: 0;
            width: 280px;
            height: 100vh;
            background: #ffffff;
            border-right: 1px solid #e1e8ed;
            transition: left 0.3s ease;
            z-index: 200;
            overflow-y: auto;
            padding-top: 70px;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.08);
        }

        .sidebar.open {
            left: 0;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(2px);
            z-index: 150;
            display: none;
        }

        .sidebar-overlay.active {
            display: block;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e1e8ed;
        }

        .sidebar-title {
            font-size: 14px;
            font-weight: 600;
            color: #8b95a5;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar-menu {
            padding: 12px 0;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: #5a6c7d;
            text-decoration: none;
            transition: all 0.3s;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .sidebar-item:hover {
            background: #f5f7fa;
            color: #2c3e50;
        }

        .sidebar-item.active {
            background: #f0f7ff;
            color: #1e88e5;
            border-left-color: #1e88e5;
        }

        .sidebar-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .page-header {
            margin-bottom: 24px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .page-subtitle {
            font-size: 14px;
            color: #5a6c7d;
        }

        .card {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
            overflow: hidden;
            border: 1px solid #e1e8ed;
            margin-bottom: 20px;
        }

        .card-header {
            background: #f5f7fa;
            padding: 16px 20px;
            border-bottom: 1px solid #e1e8ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h2 {
            font-size: 18px;
            font-weight: 700;
            color: #2c3e50;
        }

        .card-body {
            padding: 24px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 2px solid #e1e8ed;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 12px 20px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #5a6c7d;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab-button.active {
            color: #1e88e5;
            border-bottom-color: #1e88e5;
        }

        .tab-button:hover {
            color: #1e88e5;
            background: #f5f7fa;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Form elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #5a6c7d;
        }

        .form-control {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            font-size: 14px;
            background: #ffffff;
            color: #2c3e50;
            transition: all 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: #1e88e5;
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.1);
        }

        .form-control small {
            display: block;
            margin-top: 5px;
            color: #8b95a5;
            font-size: 13px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #1e88e5;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #1e88e5;
            color: white;
        }

        .btn-primary:hover {
            background: #1976d2;
            box-shadow: 0 4px 12px rgba(30, 136, 229, 0.25);
        }

        .btn-success {
            background: #43a047;
            color: white;
        }

        .btn-success:hover {
            background: #388e3c;
            box-shadow: 0 4px 12px rgba(67, 160, 71, 0.25);
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }

        /* Alerts */
        .alert {
            padding: 14px 18px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid;
        }

        .alert-success {
            background: #e8f5e9;
            border-color: #81c784;
            color: #2e7d32;
        }

        .alert-error {
            background: #ffebee;
            border-color: #e57373;
            color: #c62828;
        }

        .alert-info {
            background: #e3f2fd;
            border-color: #64b5f6;
            color: #1565c0;
        }

        .alert ul {
            margin: 8px 0 0 20px;
        }

        /* Table */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e8ed;
        }

        .table th {
            background: #f5f7fa;
            font-weight: 600;
            color: #5a6c7d;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .table tr:hover {
            background: #f5f7fa;
        }

        .table input {
            width: 100%;
            padding: 6px 10px;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            font-size: 13px;
        }

        .table input:focus {
            outline: none;
            border-color: #1e88e5;
        }

        /* Status indicator */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-connected {
            background: #43a047;
        }

        .status-disconnected {
            background: #e53935;
        }

        /* Section title */
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin: 24px 0 16px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #e1e8ed;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 16px;
        }

        .feature-card {
            display: flex;
            gap: 16px;
            padding: 20px;
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-radius: 12px;
            transition: all 0.2s;
        }

        .feature-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-color: #1e88e5;
        }

        .feature-icon {
            font-size: 36px;
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 12px;
            flex-shrink: 0;
        }

        .feature-content {
            flex: 1;
        }

        .feature-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .feature-header h3 {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }

        .feature-description {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .feature-meta {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .feature-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            background: #e3f2fd;
            color: #1976d2;
        }

        .feature-badge-required {
            background: #fff3e0;
            color: #f57c00;
        }

        .feature-badge-optional {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 48px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .3s;
            border-radius: 26px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }

        .toggle-switch input:checked + .toggle-slider {
            background-color: #4caf50;
        }

        .toggle-switch input:disabled + .toggle-slider {
            background-color: #e0e0e0;
            cursor: not-allowed;
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }

        .toggle-switch input:focus + .toggle-slider {
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .tabs {
                overflow-x: auto;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">–ù–∞–≤–∏–≥–∞—Ü–∏—è</div>
        </div>
        <div class="sidebar-menu">
            <a href="orders.html" class="sidebar-item">
                <span class="sidebar-icon">üì¶</span>
                <span>–ó–∞–∫–∞–∑—ã</span>
            </a>
            <a href="tables.html" class="sidebar-item">
                <span class="sidebar-icon">üçΩÔ∏è</span>
                <span>–°—Ç–æ–ª—ã</span>
            </a>
            <a href="kds.html" class="sidebar-item">
                <span class="sidebar-icon">üë®‚Äçüç≥</span>
                <span>KDS (–ö—É—Ö–Ω—è)</span>
            </a>
            <a href="staff.html" class="sidebar-item">
                <span class="sidebar-icon">üë•</span>
                <span>–ü–µ—Ä—Å–æ–Ω–∞–ª</span>
            </a>
            <a href="inventory.html" class="sidebar-item">
                <span class="sidebar-icon">üì¶</span>
                <span>–°–∫–ª–∞–¥</span>
            </a>
            <a href="menu.html" class="sidebar-item">
                <span class="sidebar-icon">üçï</span>
                <span>–ú–µ–Ω—é</span>
            </a>
            <a href="loyalty.html" class="sidebar-item">
                <span class="sidebar-icon">üéÅ</span>
                <span>–õ–æ—è–ª—å–Ω–æ—Å—Ç—å</span>
            </a>
            <a href="analytics.html" class="sidebar-item">
                <span class="sidebar-icon">üìä</span>
                <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
            </a>
            <a href="index.html" class="sidebar-item">
                <span class="sidebar-icon">üñ®Ô∏è</span>
                <span>–ü—Ä–∏–Ω—Ç–µ—Ä—ã</span>
            </a>
            <a href="settings.html" class="sidebar-item active">
                <span class="sidebar-icon">‚öôÔ∏è</span>
                <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </a>
            <div style="border-top: 1px solid #e1e8ed; margin: 12px 0;"></div>
            <a href="/customer-app/index.html" class="sidebar-item" target="_blank" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin: 8px; border-radius: 8px;">
                <span class="sidebar-icon">üåê</span>
                <span>–°–∞–π—Ç –∑–∞–∫–∞–∑–æ–≤</span>
                <span style="margin-left: auto; font-size: 12px;">‚Üó</span>
            </a>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-left">
            <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
            <div class="nav-brand">
                üçΩÔ∏è FoodFlow
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
            <p class="page-subtitle">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π</p>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" data-tab="general">–û–±—â–∏–µ</button>
            <button class="tab-button" data-tab="features">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª</button>
            <button class="tab-button" data-tab="roles">–†–æ–ª–∏ –∏ –¥–æ—Å—Ç—É–ø</button>
            <button class="tab-button" data-tab="pbx">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ê–¢–°</button>
            <button class="tab-button" data-tab="users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ê–¢–°</button>
            <button class="tab-button" data-tab="integration">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</button>
        </div>

        <!-- General Settings Tab -->
        <div id="general" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h2>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                </div>
                <div class="card-body">
                    <form id="generalForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è</label>
                                <input type="text" class="form-control" id="restaurantName" value="Pizza Paradise">
                            </div>
                            <div class="form-group">
                                <label>–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ</label>
                                <input type="text" class="form-control" id="legalName" value="–û–û–û 'Pizza Paradise'">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>–ê–¥—Ä–µ—Å</label>
                                <input type="text" class="form-control" id="address" value="—É–ª. –õ–µ–Ω–∏–Ω–∞, 123">
                            </div>
                            <div class="form-group">
                                <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                <input type="text" class="form-control" id="phone" value="+7 (999) 123-45-67">
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Features Toggle Tab -->
        <div id="features" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º</h2>
                    <p style="margin: 8px 0 0 0; font-size: 14px; color: #6c757d;">–í–∫–ª—é—á–∏—Ç–µ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ –º–æ–¥—É–ª–∏ —Å–∏—Å—Ç–µ–º—ã</p>
                </div>
                <div class="card-body">
                    <form id="featuresForm">
                        <div class="features-grid">
                            <!-- Tables Management -->
                            <div class="feature-card">
                                <div class="feature-icon">üçΩÔ∏è</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–∞–º–∏</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-tables" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–∞–º–∏, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–∏–∑—É–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω–µ—Ä –∑–∞–ª–∞</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge">–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å</span>
                                    </div>
                                </div>
                            </div>

                            <!-- KDS (Kitchen Display System) -->
                            <div class="feature-card">
                                <div class="feature-icon">üë®‚Äçüç≥</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>KDS - –≠–∫—Ä–∞–Ω –∫—É—Ö–Ω–∏</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-kds" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ö—É—Ö–æ–Ω–Ω—ã–π –¥–∏—Å–ø–ª–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ–≤–∞—Ä–∞–º</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge">–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Orders -->
                            <div class="feature-card">
                                <div class="feature-icon">üì¶</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-orders" checked disabled>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ü—Ä–∏—ë–º –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (–Ω–µ–ª—å–∑—è –æ—Ç–∫–ª—é—á–∏—Ç—å)</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge feature-badge-required">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Menu Management -->
                            <div class="feature-card">
                                <div class="feature-icon">üçï</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-menu" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–Ω—é, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –±–ª—é–¥–∞, —Ü–µ–Ω—ã</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge">–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Inventory -->
                            <div class="feature-card">
                                <div class="feature-icon">üì¶</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–°–∫–ª–∞–¥ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-inventory">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–£—á—ë—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤, –∑–∞–∫—É–ø–∫–∏, —Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge feature-badge-optional">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Staff Management -->
                            <div class="feature-card">
                                <div class="feature-icon">üë•</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-staff">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –∑–∞—Ä–ø–ª–∞—Ç–∞, —É—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge feature-badge-optional">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Loyalty Program -->
                            <div class="feature-card">
                                <div class="feature-icon">üéÅ</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-loyalty">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ë–æ–Ω—É—Å—ã, —Å–∫–∏–¥–∫–∏, –∞–∫—Ü–∏–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge feature-badge-optional">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Analytics -->
                            <div class="feature-card">
                                <div class="feature-icon">üìä</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-analytics" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–û—Ç—á—ë—Ç—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º, –≥—Ä–∞—Ñ–∏–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge">–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Telephony -->
                            <div class="feature-card">
                                <div class="feature-icon">üìû</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–¢–µ–ª–µ—Ñ–æ–Ω–∏—è</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-telephony">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PBX, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–≤–æ–Ω–∫–æ–≤</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge feature-badge-optional">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Printers -->
                            <div class="feature-card">
                                <div class="feature-icon">üñ®Ô∏è</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="feature-printers" checked>
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –¥–ª—è —á–µ–∫–æ–≤ –∏ –∫—É—Ö–Ω–∏</p>
                                    <div class="feature-meta">
                                        <span class="feature-badge">–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e1e8ed;">
                            <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                            <button type="button" class="btn btn-secondary" onclick="resetFeatures()">‚Ü∫ –°–±—Ä–æ—Å–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Roles and Access Control Tab -->
        <div id="roles" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ –∏ –¥–æ—Å—Ç—É–ø–æ–º</h2>
                    <p style="margin: 8px 0 0 0; font-size: 14px; color: #6c757d;">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                </div>
                <div class="card-body">
                    <form id="rolesForm">
                        <!-- Role Selection -->
                        <div class="form-group">
                            <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</label>
                            <select class="form-control" id="roleSelector" onchange="loadRolePermissions()">
                                <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                <option value="manager" selected>–ú–µ–Ω–µ–¥–∂–µ—Ä</option>
                                <option value="operator">–û–ø–µ—Ä–∞—Ç–æ—Ä</option>
                                <option value="chef">–ü–æ–≤–∞—Ä</option>
                                <option value="waiter">–û—Ñ–∏—Ü–∏–∞–Ω—Ç</option>
                            </select>
                        </div>

                        <div style="margin: 20px 0; padding: 16px; background: #e3f2fd; border-radius: 8px; border-left: 4px solid #1976d2;">
                            <strong>‚ÑπÔ∏è –¢–µ–∫—É—â–∞—è —Ä–æ–ª—å:</strong> <span id="currentRoleName">–ú–µ–Ω–µ–¥–∂–µ—Ä</span><br>
                            <small id="currentRoleDescription">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏, –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º –∏ –æ—Ç—á—ë—Ç–∞–º–∏</small>
                        </div>

                        <!-- Permissions Grid -->
                        <div class="section-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</div>
                        <div class="features-grid">
                            <!-- Orders -->
                            <div class="feature-card">
                                <div class="feature-icon">üì¶</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ó–∞–∫–∞–∑—ã</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-orders" data-permission="orders">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</p>
                                    <div style="margin-top: 8px;">
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-orders-edit" data-permission="orders-edit" style="margin: 0;">
                                            <span>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
                                        </label>
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-orders-delete" data-permission="orders-delete" style="margin: 0;">
                                            <span>–£–¥–∞–ª–µ–Ω–∏–µ</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Tables -->
                            <div class="feature-card">
                                <div class="feature-icon">üçΩÔ∏è</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–°—Ç–æ–ª—ã</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-tables" data-permission="tables">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–∞–º–∏ –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º</p>
                                    <div style="margin-top: 8px;">
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-tables-edit" data-permission="tables-edit" style="margin: 0;">
                                            <span>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- KDS -->
                            <div class="feature-card">
                                <div class="feature-icon">üë®‚Äçüç≥</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>KDS - –ö—É—Ö–Ω—è</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-kds" data-permission="kds">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–≠–∫—Ä–∞–Ω –∫—É—Ö–Ω–∏ –¥–ª—è –ø–æ–≤–∞—Ä–æ–≤</p>
                                </div>
                            </div>

                            <!-- Menu -->
                            <div class="feature-card">
                                <div class="feature-icon">üçï</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ú–µ–Ω—é</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-menu" data-permission="menu">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é –∏ –±–ª—é–¥–∞–º–∏</p>
                                    <div style="margin-top: 8px;">
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-menu-edit" data-permission="menu-edit" style="margin: 0;">
                                            <span>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
                                        </label>
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-menu-prices" data-permission="menu-prices" style="margin: 0;">
                                            <span>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Inventory -->
                            <div class="feature-card">
                                <div class="feature-icon">üì¶</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–°–∫–ª–∞–¥</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-inventory" data-permission="inventory">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º –∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏</p>
                                    <div style="margin-top: 8px;">
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-inventory-edit" data-permission="inventory-edit" style="margin: 0;">
                                            <span>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Staff -->
                            <div class="feature-card">
                                <div class="feature-icon">üë•</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ü–µ—Ä—Å–æ–Ω–∞–ª</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-staff" data-permission="staff">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</p>
                                    <div style="margin-top: 8px;">
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-staff-edit" data-permission="staff-edit" style="margin: 0;">
                                            <span>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
                                        </label>
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-staff-salary" data-permission="staff-salary" style="margin: 0;">
                                            <span>–ó–∞—Ä–ø–ª–∞—Ç—ã</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Loyalty -->
                            <div class="feature-card">
                                <div class="feature-icon">üéÅ</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-loyalty" data-permission="loyalty">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ë–æ–Ω—É—Å—ã –∏ —Å–∫–∏–¥–∫–∏</p>
                                </div>
                            </div>

                            <!-- Analytics -->
                            <div class="feature-card">
                                <div class="feature-icon">üìä</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-analytics" data-permission="analytics">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–û—Ç—á—ë—Ç—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</p>
                                    <div style="margin-top: 8px;">
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-analytics-export" data-permission="analytics-export" style="margin: 0;">
                                            <span>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Telephony -->
                            <div class="feature-card">
                                <div class="feature-icon">üìû</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–¢–µ–ª–µ—Ñ–æ–Ω–∏—è</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-telephony" data-permission="telephony">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–ó–≤–æ–Ω–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</p>
                                </div>
                            </div>

                            <!-- Settings -->
                            <div class="feature-card">
                                <div class="feature-icon">‚öôÔ∏è</div>
                                <div class="feature-content">
                                    <div class="feature-header">
                                        <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                                        <label class="toggle-switch">
                                            <input type="checkbox" id="role-settings" data-permission="settings">
                                            <span class="toggle-slider"></span>
                                        </label>
                                    </div>
                                    <p class="feature-description">–î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º</p>
                                    <div style="margin-top: 8px;">
                                        <label style="font-size: 12px; display: flex; align-items: center; gap: 6px;">
                                            <input type="checkbox" id="role-settings-advanced" data-permission="settings-advanced" style="margin: 0;">
                                            <span>–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e1e8ed;">
                            <button type="submit" class="btn btn-primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞</button>
                            <button type="button" class="btn btn-secondary" onclick="resetRolePermissions()">‚Ü∫ –°–±—Ä–æ—Å–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- PBX Settings Tab -->
        <div id="pbx" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏ PJSIP</h2>
                </div>
                <div class="card-body">
                    <div id="pbxAlert" class="alert alert-info">
                        <span class="status-indicator status-disconnected"></span>
                        <strong>–°—Ç–∞—Ç—É—Å:</strong> –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
                    </div>

                    <form id="pbxForm">
                        <div class="checkbox-group">
                            <input type="checkbox" id="pbxEnabled">
                            <label for="pbxEnabled">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω–∏—é PJSIP</label>
                        </div>

                        <div class="section-title">–¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</div>

                        <div class="form-group">
                            <label>–ú–µ—Ç–æ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</label>
                            <select class="form-control" id="connectionType" onchange="toggleConnectionType()">
                                <option value="native" selected>–ù–∞—Ç–∏–≤–Ω—ã–π PJSIP (UDP/TCP/TLS)</option>
                                <option value="websocket">WebSocket (WS/WSS)</option>
                            </select>
                            <small>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SIP —Å–µ—Ä–≤–µ—Ä—É</small>
                        </div>

                        <div id="nativeSettings">
                            <div class="section-title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã SIP —Å–µ—Ä–≤–µ—Ä–∞ (UDP/TCP)</div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>–ê–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ *</label>
                                    <input type="text" class="form-control" id="pbxServer" placeholder="sip.example.com –∏–ª–∏ 192.168.1.100">
                                    <small>IP –∞–¥—Ä–µ—Å –∏–ª–∏ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è SIP —Å–µ—Ä–≤–µ—Ä–∞</small>
                                </div>
                                <div class="form-group">
                                    <label>–ü–æ—Ä—Ç</label>
                                    <input type="number" class="form-control" id="pbxPort" value="5060" min="1" max="65535">
                                    <small>–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 5060</small>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</label>
                                    <select class="form-control" id="pbxTransport">
                                        <option value="UDP" selected>UDP</option>
                                        <option value="TCP">TCP</option>
                                        <option value="TLS">TLS (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π)</option>
                                    </select>
                                    <small>–ü—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è SIP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</small>
                                </div>
                            </div>
                        </div>

                        <div id="websocketSettings" style="display:none;">
                            <div class="section-title">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã WebSocket</div>

                            <div class="form-group">
                                <label>WebSocket URL *</label>
                                <input type="text" class="form-control" id="pbxWebSocketUrl" placeholder="wss://sip.example.com:8089/ws –∏–ª–∏ ws://192.168.1.100:8088/ws">
                                <small>–ü–æ–ª–Ω—ã–π URL WebSocket —Å–µ—Ä–≤–µ—Ä–∞ (–≤–∫–ª—é—á–∞—è –ø—Ä–æ—Ç–æ–∫–æ–ª ws:// –∏–ª–∏ wss://)</small>
                            </div>

                            <div class="alert alert-info">
                                <div>
                                    <strong>–ü—Ä–∏–º–µ—Ä—ã WebSocket URL:</strong>
                                    <ul>
                                        <li><code>wss://it005.ru:8089/ws</code> - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</li>
                                        <li><code>ws://192.168.1.100:8088/ws</code> - –æ–±—ã—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</li>
                                        <li>–î–ª—è Asterisk –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Ä—Ç 8088 –∏–ª–∏ 8089</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="alert alert-info" style="background: #fff3cd; border-color: #ffc107; color: #856404;">
                                <div>
                                    <strong>‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è WebSocket:</strong>
                                    <p style="margin: 8px 0 0 0;">–î–ª—è WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–π –ø–∞—Ä–æ–ª—å. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è WebSocket (–ø–æ–ª–µ "WS –ü–∞—Ä–æ–ª—å").</p>
                                </div>
                            </div>
                        </div>

                        <div class="section-title">–ü–æ—Ä—Ç—ã –¥–ª—è –º–µ–¥–∏–∞ (RTP)</div>

                        <div id="rtpPortsInfo" class="alert alert-info">
                            <div>
                                <strong>‚ÑπÔ∏è –ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã RTP –ø–æ—Ä—Ç—ã:</strong>
                                <ul style="margin: 8px 0 0 0;">
                                    <li><strong>Native PJSIP (UDP/TCP/TLS)</strong> - ‚úÖ –ù–µ–æ–±—Ö–æ–¥–∏–º—ã. –°–µ—Ä–≤–∏—Å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—É–¥–∏–æ –Ω–∞–ø—Ä—è–º—É—é.</li>
                                    <li><strong>WebSocket (WS/WSS)</strong> - ‚ùå –ù–µ –Ω—É–∂–Ω—ã. –ú–µ–¥–∏–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä —á–µ—Ä–µ–∑ WebRTC.</li>
                                    <li><strong>–¢–æ–ª—å–∫–æ AMI</strong> - ‚ùå –ù–µ –Ω—É–∂–Ω—ã. AMI —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–≤–æ–Ω–∫–∞–º–∏ –±–µ–∑ –º–µ–¥–∏–∞.</li>
                                </ul>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>–ù–∞—á–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç</label>
                                <input type="number" class="form-control" id="rtpPortMin" value="5700" min="1024" max="65535">
                            </div>
                            <div class="form-group">
                                <label>–ö–æ–Ω–µ—á–Ω—ã–π –ø–æ—Ä—Ç</label>
                                <input type="number" class="form-control" id="rtpPortMax" value="5750" min="1024" max="65535">
                            </div>
                        </div>

                        <div class="alert alert-info">
                            <div>
                                <strong>–í–∞–∂–Ω–æ!</strong> –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–∞ –≤–∞—à–µ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏ –æ—Ç–∫—Ä—ã—Ç—ã:
                                <ul>
                                    <li>–ü–æ—Ä—Ç 5060 (–∏–ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤—ã—à–µ) –¥–ª—è SIP - –ø—Ä–æ—Ç–æ–∫–æ–ª—ã TCP –∏ UDP</li>
                                    <li>–î–∏–∞–ø–∞–∑–æ–Ω –ø–æ—Ä—Ç–æ–≤ 5700-5750 –¥–ª—è RTP - –ø—Ä–æ—Ç–æ–∫–æ–ª UDP</li>
                                    <li>–ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –¥–ª—è –≤—Ö–æ–¥—è—â–µ–≥–æ –∏ –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞</li>
                                </ul>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                        <button type="button" class="btn btn-success" onclick="testConnection()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- PBX Users Tab -->
        <div id="users" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫ —Ç–µ–ª–µ—Ñ–æ–Ω–∏–∏</h2>
                </div>
                <div class="card-body">
                    <p style="margin-bottom: 20px; color: #5a6c7d;">–£–∫–∞–∂–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª–∏ –ê–¢–° –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–µ–ª–µ—Ñ–æ–Ω–∏–µ–π.</p>

                    <div class="alert alert-info" style="margin-bottom: 20px;">
                        <strong>–¢–∏–ø—ã –ø–∞—Ä–æ–ª–µ–π:</strong>
                        <ul style="margin: 8px 0 0 20px;">
                            <li><strong>–ü–∞—Ä–æ–ª—å SIP</strong> - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (UDP/TCP/TLS)</li>
                            <li><strong>–ü–∞—Ä–æ–ª—å WS</strong> - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è)</li>
                        </ul>
                    </div>

                    <table class="table">
                        <thead>
                            <tr>
                                <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                                <th>–†–æ–ª—å</th>
                                <th>–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –Ω–æ–º–µ—Ä</th>
                                <th>–õ–æ–≥–∏–Ω –ê–¢–°</th>
                                <th>–ü–∞—Ä–æ–ª—å SIP</th>
                                <th>–ü–∞—Ä–æ–ª—å WS</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Integrations Tab -->
        <div id="integration" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</h2>
                </div>
                <div class="card-body">
                    <p style="color: #5a6c7d;">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        // Tab switching
        document.querySelectorAll('.tab-button').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.dataset.tab;

                // Update tabs
                document.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update content
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Toggle between native and WebSocket connection types
        function toggleConnectionType() {
            const connectionType = document.getElementById('connectionType').value;
            const nativeSettings = document.getElementById('nativeSettings');
            const websocketSettings = document.getElementById('websocketSettings');

            if (connectionType === 'websocket') {
                nativeSettings.style.display = 'none';
                websocketSettings.style.display = 'block';
            } else {
                nativeSettings.style.display = 'block';
                websocketSettings.style.display = 'none';
            }
        }

        // Load PBX settings
        async function loadPBXSettings() {
            try {
                const response = await fetch('/api/restaurants/650e8400-e29b-41d4-a716-446655440001/pbx-settings');
                const data = await response.json();

                if (data) {
                    document.getElementById('pbxEnabled').checked = data.pbx_enabled;
                    document.getElementById('pbxServer').value = data.pbx_server || '';
                    document.getElementById('pbxPort').value = data.pbx_port || 5060;
                    document.getElementById('pbxTransport').value = data.pbx_transport || 'UDP';
                    document.getElementById('rtpPortMin').value = data.pbx_rtp_port_min || 5700;
                    document.getElementById('rtpPortMax').value = data.pbx_rtp_port_max || 5750;
                    document.getElementById('pbxWebSocketUrl').value = data.pbx_websocket_url || '';

                    // Set connection type based on data
                    if (data.pbx_use_websocket) {
                        document.getElementById('connectionType').value = 'websocket';
                        toggleConnectionType();
                    }
                }
            } catch (error) {
                console.error('Failed to load PBX settings:', error);
            }
        }

        // Save PBX settings
        document.getElementById('pbxForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const connectionType = document.getElementById('connectionType').value;
            const useWebSocket = connectionType === 'websocket';

            const settings = {
                pbx_enabled: document.getElementById('pbxEnabled').checked,
                pbx_server: useWebSocket ? '' : document.getElementById('pbxServer').value,
                pbx_port: useWebSocket ? null : parseInt(document.getElementById('pbxPort').value),
                pbx_transport: useWebSocket ? '' : document.getElementById('pbxTransport').value,
                pbx_rtp_port_min: parseInt(document.getElementById('rtpPortMin').value),
                pbx_rtp_port_max: parseInt(document.getElementById('rtpPortMax').value),
                pbx_websocket_url: useWebSocket ? document.getElementById('pbxWebSocketUrl').value : '',
                pbx_use_websocket: useWebSocket
            };

            try {
                const response = await fetch('/api/restaurants/650e8400-e29b-41d4-a716-446655440001/pbx-settings', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(settings)
                });

                if (response.ok) {
                    showAlert('success', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                } else {
                    showAlert('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫');
                }
            } catch (error) {
                showAlert('error', '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
            }
        });

        // Test SIP connection
        async function testConnection() {
            showAlert('info', '–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...');

            const server = document.getElementById('pbxServer').value;
            const port = document.getElementById('pbxPort').value;
            const transport = document.getElementById('pbxTransport').value;

            try {
                const response = await fetch('/api/pbx/test-connection', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ server, port, transport })
                });
                const data = await response.json();

                if (data.success) {
                    showAlert('success', data.message);
                } else {
                    showAlert('error', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ SIP —Å–µ—Ä–≤–µ—Ä—É');
                }
            } catch (error) {
                showAlert('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
            }
        }

        // Load users for PBX configuration
        async function loadUsers() {
            try {
                const response = await fetch('/api/users');
                const data = await response.json();

                const tbody = document.getElementById('usersTableBody');
                tbody.innerHTML = '';

                // –ü–µ—Ä–µ–≤–æ–¥–∏–º —Ä–æ–ª–∏ –Ω–∞ —Ä—É—Å—Å–∫–∏–π
                const roleNames = {
                    'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                    'customer': '–ö–ª–∏–µ–Ω—Ç',
                    'restaurant_owner': '–í–ª–∞–¥–µ–ª–µ—Ü —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞',
                    'delivery_driver': '–í–æ–¥–∏—Ç–µ–ª—å –¥–æ—Å—Ç–∞–≤–∫–∏'
                };

                data.users.forEach(user => {
                    const row = document.createElement('tr');
                    const fullName = `${user.first_name} ${user.last_name}`;
                    const roleName = roleNames[user.role] || user.role;

                    row.innerHTML = `
                        <td>${fullName}</td>
                        <td>${roleName}</td>
                        <td>
                            <input type="text" value="${user.pbx_extension || ''}"
                                   placeholder="1001"
                                   data-user-id="${user.id}"
                                   data-field="pbx_extension">
                        </td>
                        <td>
                            <input type="text" value="${user.pbx_username || ''}"
                                   placeholder="operator1"
                                   data-user-id="${user.id}"
                                   data-field="pbx_username">
                        </td>
                        <td>
                            <input type="password" value="${user.pbx_password || ''}"
                                   placeholder="SIP –ø–∞—Ä–æ–ª—å"
                                   data-user-id="${user.id}"
                                   data-field="pbx_password"
                                   title="–ü–∞—Ä–æ–ª—å –¥–ª—è UDP/TCP/TLS">
                        </td>
                        <td>
                            <input type="password" value="${user.pbx_ws_password || ''}"
                                   placeholder="WS –ø–∞—Ä–æ–ª—å"
                                   data-user-id="${user.id}"
                                   data-field="pbx_ws_password"
                                   title="–ü–∞—Ä–æ–ª—å –¥–ª—è WebSocket">
                        </td>
                        <td>
                            <button onclick="saveUserPBX('${user.id}')" class="btn btn-primary btn-sm">
                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            } catch (error) {
                console.error('Failed to load users:', error);
                showAlert('error', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π');
            }
        }

        // Update user PBX settings
        async function saveUserPBX(userId) {
            const inputs = document.querySelectorAll(`[data-user-id="${userId}"]`);
            const data = {};

            inputs.forEach(input => {
                const field = input.dataset.field;
                data[field] = input.value;
            });

            try {
                const response = await fetch(`/api/users/${userId}/pbx-settings`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    showAlert('success', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                } else {
                    showAlert('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏');
                }
            } catch (error) {
                showAlert('error', '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
            }
        }

        function showAlert(type, message) {
            const alertDiv = document.getElementById('pbxAlert');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.innerHTML = message;

            setTimeout(() => {
                alertDiv.className = 'alert alert-info';
                alertDiv.innerHTML = '<span class="status-indicator status-disconnected"></span><strong>–°—Ç–∞—Ç—É—Å:</strong> –ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ';
            }, 5000);
        }

        // Initialize
        loadPBXSettings();
        loadUsers();
        loadFeatureSettings();

        // ========== Feature Toggles Functions ==========

        // Load feature settings
        function loadFeatureSettings() {
            const savedSettings = localStorage.getItem('featureSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                Object.keys(settings).forEach(key => {
                    const checkbox = document.getElementById(`feature-${key}`);
                    if (checkbox && !checkbox.disabled) {
                        checkbox.checked = settings[key];
                    }
                });
            }
        }

        // Save feature settings
        document.getElementById('featuresForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const features = {
                tables: document.getElementById('feature-tables').checked,
                kds: document.getElementById('feature-kds').checked,
                orders: document.getElementById('feature-orders').checked,
                menu: document.getElementById('feature-menu').checked,
                inventory: document.getElementById('feature-inventory').checked,
                staff: document.getElementById('feature-staff').checked,
                loyalty: document.getElementById('feature-loyalty').checked,
                analytics: document.getElementById('feature-analytics').checked,
                telephony: document.getElementById('feature-telephony').checked,
                printers: document.getElementById('feature-printers').checked
            };

            // Save to localStorage
            localStorage.setItem('featureSettings', JSON.stringify(features));

            // Show success message
            alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!\n\n–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø–∏–ª–∏ –≤ —Å–∏–ª—É.');

            // Optional: Send to backend API
            try {
                const response = await fetch('/api/settings/features', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(features)
                });

                if (response.ok) {
                    console.log('Features saved to backend');
                }
            } catch (error) {
                console.log('Backend not available, using localStorage only');
            }
        });

        // Reset to default
        function resetFeatures() {
            if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é?')) return;

            const defaultFeatures = {
                tables: true,
                kds: true,
                orders: true,
                menu: true,
                inventory: false,
                staff: false,
                loyalty: false,
                analytics: true,
                telephony: false,
                printers: true
            };

            Object.keys(defaultFeatures).forEach(key => {
                const checkbox = document.getElementById(`feature-${key}`);
                if (checkbox && !checkbox.disabled) {
                    checkbox.checked = defaultFeatures[key];
                }
            });

            localStorage.setItem('featureSettings', JSON.stringify(defaultFeatures));
            alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
        }

        // Check if feature is enabled
        function isFeatureEnabled(featureName) {
            const savedSettings = localStorage.getItem('featureSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                return settings[featureName] !== false;
            }
            // Default values if not set
            const defaults = {
                tables: true,
                kds: true,
                orders: true,
                menu: true,
                inventory: false,
                staff: false,
                loyalty: false,
                analytics: true,
                telephony: false,
                printers: true
            };
            return defaults[featureName] !== false;
        }

        // Role-based access control
        const rolePermissions = {
            admin: {
                name: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                description: '–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Å–∏—Å—Ç–µ–º—ã',
                permissions: {
                    orders: true, 'orders-edit': true, 'orders-delete': true,
                    tables: true, 'tables-edit': true,
                    kds: true,
                    menu: true, 'menu-edit': true, 'menu-prices': true,
                    inventory: true, 'inventory-edit': true,
                    staff: true, 'staff-edit': true, 'staff-salary': true,
                    loyalty: true,
                    analytics: true, 'analytics-export': true,
                    telephony: true,
                    settings: true, 'settings-advanced': true
                }
            },
            manager: {
                name: '–ú–µ–Ω–µ–¥–∂–µ—Ä',
                description: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏, –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º –∏ –æ—Ç—á—ë—Ç–∞–º–∏',
                permissions: {
                    orders: true, 'orders-edit': true, 'orders-delete': true,
                    tables: true, 'tables-edit': true,
                    kds: false,
                    menu: true, 'menu-edit': true, 'menu-prices': false,
                    inventory: true, 'inventory-edit': false,
                    staff: true, 'staff-edit': true, 'staff-salary': false,
                    loyalty: true,
                    analytics: true, 'analytics-export': true,
                    telephony: true,
                    settings: false, 'settings-advanced': false
                }
            },
            operator: {
                name: '–û–ø–µ—Ä–∞—Ç–æ—Ä',
                description: '–ü—Ä–∏—ë–º –∑–∞–∫–∞–∑–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–∞–º–∏',
                permissions: {
                    orders: true, 'orders-edit': true, 'orders-delete': false,
                    tables: true, 'tables-edit': true,
                    kds: false,
                    menu: true, 'menu-edit': false, 'menu-prices': false,
                    inventory: false, 'inventory-edit': false,
                    staff: false, 'staff-edit': false, 'staff-salary': false,
                    loyalty: true,
                    analytics: false, 'analytics-export': false,
                    telephony: true,
                    settings: false, 'settings-advanced': false
                }
            },
            chef: {
                name: '–ü–æ–≤–∞—Ä',
                description: '–†–∞–±–æ—Ç–∞ —Å —ç–∫—Ä–∞–Ω–æ–º –∫—É—Ö–Ω–∏ –∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏',
                permissions: {
                    orders: true, 'orders-edit': false, 'orders-delete': false,
                    tables: false, 'tables-edit': false,
                    kds: true,
                    menu: true, 'menu-edit': false, 'menu-prices': false,
                    inventory: true, 'inventory-edit': false,
                    staff: false, 'staff-edit': false, 'staff-salary': false,
                    loyalty: false,
                    analytics: false, 'analytics-export': false,
                    telephony: false,
                    settings: false, 'settings-advanced': false
                }
            },
            waiter: {
                name: '–û—Ñ–∏—Ü–∏–∞–Ω—Ç',
                description: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–∞–º–∏ –∏ –∑–∞–∫–∞–∑–∞–º–∏',
                permissions: {
                    orders: true, 'orders-edit': true, 'orders-delete': false,
                    tables: true, 'tables-edit': false,
                    kds: false,
                    menu: true, 'menu-edit': false, 'menu-prices': false,
                    inventory: false, 'inventory-edit': false,
                    staff: false, 'staff-edit': false, 'staff-salary': false,
                    loyalty: true,
                    analytics: false, 'analytics-export': false,
                    telephony: false,
                    settings: false, 'settings-advanced': false
                }
            }
        };

        // Load role permissions
        function loadRolePermissions() {
            const roleSelector = document.getElementById('roleSelector');
            const selectedRole = roleSelector.value;

            // Update role info
            document.getElementById('currentRoleName').textContent = rolePermissions[selectedRole].name;
            document.getElementById('currentRoleDescription').textContent = rolePermissions[selectedRole].description;

            // Load saved permissions or defaults
            const savedPermissions = JSON.parse(localStorage.getItem('rolePermissions') || '{}');
            const permissions = savedPermissions[selectedRole] || rolePermissions[selectedRole].permissions;

            // Update checkboxes
            document.querySelectorAll('[data-permission]').forEach(checkbox => {
                const permission = checkbox.dataset.permission;
                checkbox.checked = permissions[permission] || false;
            });
        }

        // Save role permissions
        document.getElementById('rolesForm')?.addEventListener('submit', function(e) {
            e.preventDefault();

            const roleSelector = document.getElementById('roleSelector');
            const selectedRole = roleSelector.value;

            const permissions = {};
            document.querySelectorAll('[data-permission]').forEach(checkbox => {
                permissions[checkbox.dataset.permission] = checkbox.checked;
            });

            // Save to localStorage
            const allPermissions = JSON.parse(localStorage.getItem('rolePermissions') || '{}');
            allPermissions[selectedRole] = permissions;
            localStorage.setItem('rolePermissions', JSON.stringify(allPermissions));

            alert(`‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —Ä–æ–ª–∏ "${rolePermissions[selectedRole].name}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!`);
        });

        // Reset role permissions
        function resetRolePermissions() {
            const roleSelector = document.getElementById('roleSelector');
            const selectedRole = roleSelector.value;

            if (!confirm(`–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —Ä–æ–ª–∏ "${rolePermissions[selectedRole].name}" –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é?`)) {
                return;
            }

            // Load default permissions
            const permissions = rolePermissions[selectedRole].permissions;

            document.querySelectorAll('[data-permission]').forEach(checkbox => {
                const permission = checkbox.dataset.permission;
                checkbox.checked = permissions[permission] || false;
            });

            // Remove from localStorage
            const allPermissions = JSON.parse(localStorage.getItem('rolePermissions') || '{}');
            delete allPermissions[selectedRole];
            localStorage.setItem('rolePermissions', JSON.stringify(allPermissions));

            alert('‚úÖ –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —Å–±—Ä–æ—à–µ–Ω—ã –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
        }

        // Check if user has permission
        function hasPermission(userRole, permission) {
            const savedPermissions = JSON.parse(localStorage.getItem('rolePermissions') || '{}');
            const rolePerms = savedPermissions[userRole] || rolePermissions[userRole]?.permissions || {};
            return rolePerms[permission] === true;
        }

        // Expose globally for navigation
        window.isFeatureEnabled = isFeatureEnabled;
        window.hasPermission = hasPermission;

        // Initialize role permissions on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Load role permissions when roles tab is active
            const rolesTab = document.querySelector('[data-tab="roles"]');
            if (rolesTab) {
                rolesTab.addEventListener('click', function() {
                    setTimeout(loadRolePermissions, 100);
                });
            }
        });
    </script>
</body>
</html>
