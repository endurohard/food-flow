<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Food Flow - –î–æ—Å—Ç–∞–≤–∫–∞ –ï–¥—ã</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçï</text></svg>">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
      color: #333;
    }

    /* Header */
    .header {
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-size: 28px;
      font-weight: 700;
      color: #FF6B6B;
    }

    .cart-button {
      position: relative;
      padding: 12px 24px;
      background: #FF6B6B;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .cart-button:hover {
      background: #ff5252;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
    }

    .cart-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #4CAF50;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 700;
    }

    /* Main Container */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    /* Categories */
    .categories {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      overflow-x: auto;
      padding-bottom: 10px;
    }

    .category-chip {
      padding: 10px 20px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 20px;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
      font-size: 14px;
      font-weight: 500;
    }

    .category-chip:hover {
      border-color: #FF6B6B;
    }

    .category-chip.active {
      background: #FF6B6B;
      color: white;
      border-color: #FF6B6B;
    }

    /* Menu Grid */
    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 24px;
      margin-bottom: 30px;
    }

    .menu-item {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.3s;
      cursor: pointer;
    }

    .menu-item:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }

    .item-image {
      width: 100%;
      height: 200px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 64px;
    }

    .item-content {
      padding: 16px;
    }

    .item-name {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .item-description {
      font-size: 14px;
      color: #666;
      margin-bottom: 12px;
      line-height: 1.4;
    }

    .item-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .item-price {
      font-size: 24px;
      font-weight: 700;
      color: #FF6B6B;
    }

    .add-to-cart {
      padding: 8px 16px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .add-to-cart:hover {
      background: #45a049;
      transform: scale(1.05);
    }

    /* Cart Modal */
    .cart-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .cart-modal.active {
      display: flex;
    }

    .cart-content {
      background: white;
      border-radius: 16px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .cart-header {
      padding: 24px;
      background: #FF6B6B;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .cart-title {
      font-size: 24px;
      font-weight: 700;
    }

    .close-cart {
      background: none;
      border: none;
      color: white;
      font-size: 32px;
      cursor: pointer;
      line-height: 1;
    }

    .cart-items {
      padding: 24px;
    }

    .cart-item {
      display: flex;
      gap: 16px;
      padding: 16px;
      background: #f9f9f9;
      border-radius: 8px;
      margin-bottom: 12px;
    }

    .cart-item-image {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      flex-shrink: 0;
    }

    .cart-item-info {
      flex: 1;
    }

    .cart-item-name {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .cart-item-price {
      font-size: 14px;
      color: #666;
    }

    .cart-item-controls {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 8px;
    }

    .quantity-btn {
      width: 32px;
      height: 32px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      cursor: pointer;
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .quantity-btn:hover {
      border-color: #FF6B6B;
      color: #FF6B6B;
    }

    .quantity {
      font-size: 16px;
      font-weight: 600;
      min-width: 30px;
      text-align: center;
    }

    .remove-item {
      background: none;
      border: none;
      color: #F44336;
      font-size: 20px;
      cursor: pointer;
      padding: 4px;
    }

    .cart-empty {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .cart-empty-icon {
      font-size: 64px;
      margin-bottom: 16px;
    }

    .cart-summary {
      padding: 24px;
      background: #f9f9f9;
      border-top: 1px solid #e0e0e0;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      font-size: 16px;
    }

    .summary-row.total {
      font-size: 24px;
      font-weight: 700;
      color: #FF6B6B;
      padding-top: 12px;
      border-top: 2px solid #e0e0e0;
    }

    .checkout-btn {
      width: 100%;
      padding: 16px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 16px;
      transition: all 0.2s;
    }

    .checkout-btn:hover {
      background: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
    }

    .checkout-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    /* Checkout Modal */
    .checkout-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1001;
      align-items: center;
      justify-content: center;
    }

    .checkout-modal.active {
      display: flex;
    }

    .checkout-content {
      background: white;
      border-radius: 16px;
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .checkout-header {
      padding: 24px;
      background: #4CAF50;
      color: white;
    }

    .checkout-form {
      padding: 24px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }

    .form-input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.2s;
    }

    .form-input:focus {
      outline: none;
      border-color: #4CAF50;
    }

    .form-textarea {
      min-height: 100px;
      resize: vertical;
    }

    .submit-order {
      width: 100%;
      padding: 16px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }

    .submit-order:hover {
      background: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
    }

    /* Success Modal */
    .success-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1002;
      align-items: center;
      justify-content: center;
    }

    .success-modal.active {
      display: flex;
    }

    .success-content {
      background: white;
      border-radius: 16px;
      padding: 40px;
      text-align: center;
      max-width: 400px;
    }

    .success-icon {
      font-size: 80px;
      margin-bottom: 20px;
    }

    .success-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 12px;
      color: #4CAF50;
    }

    .success-message {
      font-size: 16px;
      color: #666;
      margin-bottom: 24px;
    }

    .order-number {
      font-size: 20px;
      font-weight: 700;
      color: #FF6B6B;
      margin-bottom: 24px;
    }

    .close-success {
      padding: 12px 32px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #999;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <div class="logo">üçï Food Flow</div>
      <button class="cart-button" onclick="openCart()">
        üõí –ö–æ—Ä–∑–∏–Ω–∞
        <span class="cart-badge" id="cartBadge">0</span>
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="container">
    <!-- Categories -->
    <div class="categories" id="categories">
      <div class="category-chip active" data-category="all">–í—Å–µ</div>
      <div class="category-chip" data-category="pizza">üçï –ü–∏—Ü—Ü–∞</div>
      <div class="category-chip" data-category="burger">üçî –ë—É—Ä–≥–µ—Ä—ã</div>
      <div class="category-chip" data-category="sushi">üç£ –°—É—à–∏</div>
      <div class="category-chip" data-category="drinks">ü•§ –ù–∞–ø–∏—Ç–∫–∏</div>
      <div class="category-chip" data-category="desserts">üç∞ –î–µ—Å–µ—Ä—Ç—ã</div>
    </div>

    <!-- Menu Grid -->
    <div class="menu-grid" id="menuGrid"></div>
  </div>

  <!-- Cart Modal -->
  <div class="cart-modal" id="cartModal">
    <div class="cart-content">
      <div class="cart-header">
        <div class="cart-title">–ö–æ—Ä–∑–∏–Ω–∞</div>
        <button class="close-cart" onclick="closeCart()">√ó</button>
      </div>
      <div class="cart-items" id="cartItems">
        <div class="cart-empty">
          <div class="cart-empty-icon">üõí</div>
          <div>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>
        </div>
      </div>
      <div class="cart-summary" id="cartSummary" style="display: none;">
        <div class="summary-row">
          <span>–¢–æ–≤–∞—Ä—ã:</span>
          <span id="subtotal">0 ‚ÇΩ</span>
        </div>
        <div class="summary-row">
          <span>–î–æ—Å—Ç–∞–≤–∫–∞:</span>
          <span id="delivery">200 ‚ÇΩ</span>
        </div>
        <div class="summary-row total">
          <span>–ò—Ç–æ–≥–æ:</span>
          <span id="total">0 ‚ÇΩ</span>
        </div>
        <button class="checkout-btn" onclick="openCheckout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
      </div>
    </div>
  </div>

  <!-- Checkout Modal -->
  <div class="checkout-modal" id="checkoutModal">
    <div class="checkout-content">
      <div class="checkout-header">
        <h2>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
      </div>
      <form class="checkout-form" id="checkoutForm" onsubmit="submitOrder(event)">
        <div class="form-group">
          <label class="form-label">–ò–º—è *</label>
          <input type="text" class="form-input" required name="name" placeholder="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤">
        </div>
        <div class="form-group">
          <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
          <input type="tel" class="form-input" required name="phone" placeholder="+7 (999) 123-45-67">
        </div>
        <div class="form-group">
          <label class="form-label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
          <textarea class="form-input form-textarea" required name="address" placeholder="—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10, –∫–≤. 5"></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
          <textarea class="form-input" name="comment" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –Ω–µ –∑–≤–æ–Ω–∏—Ç—å –≤ –¥–≤–µ—Ä—å"></textarea>
        </div>
        <button type="submit" class="submit-order">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
      </form>
    </div>
  </div>

  <!-- Success Modal -->
  <div class="success-modal" id="successModal">
    <div class="success-content">
      <div class="success-icon">‚úÖ</div>
      <div class="success-title">–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç!</div>
      <div class="success-message">–í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω –∏ –ø–µ—Ä–µ–¥–∞–Ω –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É</div>
      <div class="order-number" id="orderNumber">–ó–∞–∫–∞–∑ #ORD-1234</div>
      <button class="close-success" onclick="closeSuccess()">–û—Ç–ª–∏—á–Ω–æ!</button>
    </div>
  </div>

  <script>
    // API Configuration
    const API_BASE_URL = 'http://localhost/api';

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    let menuItems = [];
    let cart = [];
    let currentCategory = 'all';
    let restaurantId = 1; // ID —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', () => {
      loadMenu();
      setupCategoryFilters();
      updateCartBadge();
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é —Å —Å–µ—Ä–≤–µ—Ä–∞
    async function loadMenu() {
      try {
        // –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–Ω—é —Å API
        const response = await fetch(`${API_BASE_URL}/menus`);
        if (response.ok) {
          const data = await response.json();
          menuItems = data.map(item => ({
            id: item.id,
            name: item.name,
            category: item.category || 'other',
            price: item.price,
            description: item.description || '',
            emoji: getCategoryEmoji(item.category)
          }));
        } else {
          // Fallback –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
          loadTestData();
        }
      } catch (error) {
        console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ–Ω—é —Å —Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ');
        loadTestData();
      }

      renderMenu();
    }

    // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    function loadTestData() {
      menuItems = [
        { id: 1, name: '–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞', category: 'pizza', price: 450, description: '–¢–æ–º–∞—Ç—ã, –º–æ—Ü–∞—Ä–µ–ª–ª–∞, –±–∞–∑–∏–ª–∏–∫', emoji: 'üçï' },
        { id: 2, name: '–ü–µ–ø–ø–µ—Ä–æ–Ω–∏', category: 'pizza', price: 550, description: '–ü–µ–ø–ø–µ—Ä–æ–Ω–∏, –º–æ—Ü–∞—Ä–µ–ª–ª–∞, —Ç–æ–º–∞—Ç–Ω—ã–π —Å–æ—É—Å', emoji: 'üçï' },
        { id: 3, name: '–ß–µ—Ç—ã—Ä–µ —Å—ã—Ä–∞', category: 'pizza', price: 650, description: '–ú–æ—Ü–∞—Ä–µ–ª–ª–∞, –ø–∞—Ä–º–µ–∑–∞–Ω, –≥–æ—Ä–≥–æ–Ω–∑–æ–ª–∞, –¥–æ—Ä –±–ª—é', emoji: 'üçï' },
        { id: 4, name: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –±—É—Ä–≥–µ—Ä', category: 'burger', price: 350, description: '–ì–æ–≤—è–¥–∏–Ω–∞, —Å–∞–ª–∞—Ç, —Ç–æ–º–∞—Ç, —Å—ã—Ä', emoji: 'üçî' },
        { id: 5, name: '–ß–∏–∑–±—É—Ä–≥–µ—Ä', category: 'burger', price: 400, description: '–î–≤–æ–π–Ω–∞—è –∫–æ—Ç–ª–µ—Ç–∞, –¥–≤–æ–π–Ω–æ–π —Å—ã—Ä', emoji: 'üçî' },
        { id: 6, name: '–§–∏–ª–∞–¥–µ–ª—å—Ñ–∏—è', category: 'sushi', price: 520, description: '–õ–æ—Å–æ—Å—å, —Å—ã—Ä, –æ–≥—É—Ä–µ—Ü', emoji: 'üç£' },
        { id: 7, name: '–ö–∞–ª–∏—Ñ–æ—Ä–Ω–∏—è', category: 'sushi', price: 480, description: '–ö—Ä–∞–±, –∞–≤–æ–∫–∞–¥–æ, –∏–∫—Ä–∞ —Ç–æ–±–∏–∫–æ', emoji: 'üç£' },
        { id: 8, name: 'Coca-Cola', category: 'drinks', price: 120, description: '0.5–ª', emoji: 'ü•§' },
        { id: 9, name: 'Sprite', category: 'drinks', price: 120, description: '0.5–ª', emoji: 'ü•§' },
        { id: 10, name: '–¢–∏—Ä–∞–º–∏—Å—É', category: 'desserts', price: 280, description: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏—Ç–∞–ª—å—è–Ω—Å–∫–∏–π –¥–µ—Å–µ—Ä—Ç', emoji: 'üç∞' },
        { id: 11, name: '–ß–∏–∑–∫–µ–π–∫', category: 'desserts', price: 250, description: '–ù—å—é-–π–æ—Ä–∫—Å–∫–∏–π —á–∏–∑–∫–µ–π–∫', emoji: 'üç∞' },
      ];
    }

    // –ü–æ–ª—É—á–∏—Ç—å —ç–º–æ–¥–∑–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    function getCategoryEmoji(category) {
      const emojis = {
        'pizza': 'üçï',
        'burger': 'üçî',
        'sushi': 'üç£',
        'drinks': 'ü•§',
        'desserts': 'üç∞',
        'hot': 'üç≤',
        'cold': 'ü•ó'
      };
      return emojis[category] || 'üçΩÔ∏è';
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–Ω—é
    function renderMenu() {
      const grid = document.getElementById('menuGrid');
      const filtered = currentCategory === 'all'
        ? menuItems
        : menuItems.filter(item => item.category === currentCategory);

      grid.innerHTML = filtered.map(item => `
        <div class="menu-item" onclick="addToCart(${item.id})">
          <div class="item-image">${item.emoji}</div>
          <div class="item-content">
            <div class="item-name">${item.name}</div>
            <div class="item-description">${item.description}</div>
            <div class="item-footer">
              <div class="item-price">${item.price} ‚ÇΩ</div>
              <button class="add-to-cart" onclick="event.stopPropagation(); addToCart(${item.id})">
                + –í –∫–æ—Ä–∑–∏–Ω—É
              </button>
            </div>
          </div>
        </div>
      `).join('');
    }

    // –§–∏–ª—å—Ç—Ä—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π
    function setupCategoryFilters() {
      document.querySelectorAll('.category-chip').forEach(chip => {
        chip.addEventListener('click', () => {
          document.querySelectorAll('.category-chip').forEach(c => c.classList.remove('active'));
          chip.classList.add('active');
          currentCategory = chip.dataset.category;
          renderMenu();
        });
      });
    }

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É
    function addToCart(itemId) {
      const item = menuItems.find(i => i.id === itemId);
      const cartItem = cart.find(i => i.id === itemId);

      if (cartItem) {
        cartItem.quantity++;
      } else {
        cart.push({ ...item, quantity: 1 });
      }

      updateCartBadge();
      showNotification(`${item.name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É`);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–π–¥–∂–∞ –∫–æ—Ä–∑–∏–Ω—ã
    function updateCartBadge() {
      const badge = document.getElementById('cartBadge');
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      badge.textContent = totalItems;
      badge.style.display = totalItems > 0 ? 'flex' : 'none';
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
    function openCart() {
      document.getElementById('cartModal').classList.add('active');
      renderCart();
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
    function closeCart() {
      document.getElementById('cartModal').classList.remove('active');
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
    function renderCart() {
      const cartItemsEl = document.getElementById('cartItems');
      const cartSummary = document.getElementById('cartSummary');

      if (cart.length === 0) {
        cartItemsEl.innerHTML = `
          <div class="cart-empty">
            <div class="cart-empty-icon">üõí</div>
            <div>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>
          </div>
        `;
        cartSummary.style.display = 'none';
        return;
      }

      cartItemsEl.innerHTML = cart.map(item => `
        <div class="cart-item">
          <div class="cart-item-image">${item.emoji}</div>
          <div class="cart-item-info">
            <div class="cart-item-name">${item.name}</div>
            <div class="cart-item-price">${item.price} ‚ÇΩ</div>
            <div class="cart-item-controls">
              <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">‚àí</button>
              <span class="quantity">${item.quantity}</span>
              <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
              <button class="remove-item" onclick="removeFromCart(${item.id})">üóëÔ∏è</button>
            </div>
          </div>
        </div>
      `).join('');

      const subtotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
      const delivery = 200;
      const total = subtotal + delivery;

      document.getElementById('subtotal').textContent = `${subtotal} ‚ÇΩ`;
      document.getElementById('delivery').textContent = `${delivery} ‚ÇΩ`;
      document.getElementById('total').textContent = `${total} ‚ÇΩ`;
      cartSummary.style.display = 'block';
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
    function updateQuantity(itemId, delta) {
      const item = cart.find(i => i.id === itemId);
      if (item) {
        item.quantity += delta;
        if (item.quantity <= 0) {
          removeFromCart(itemId);
        } else {
          renderCart();
          updateCartBadge();
        }
      }
    }

    // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
    function removeFromCart(itemId) {
      cart = cart.filter(i => i.id !== itemId);
      renderCart();
      updateCartBadge();
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
    function openCheckout() {
      closeCart();
      document.getElementById('checkoutModal').classList.add('active');
    }

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞
    async function submitOrder(event) {
      event.preventDefault();

      const formData = new FormData(event.target);
      const subtotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
      const deliveryFee = 200;
      const total = subtotal + deliveryFee;

      const orderData = {
        restaurantId: restaurantId,
        customerId: null, // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–∑–∂–µ
        customer: {
          name: formData.get('name'),
          phone: formData.get('phone')
        },
        deliveryAddress: formData.get('address'),
        items: cart.map(item => ({
          menuItemId: item.id,
          name: item.name,
          quantity: item.quantity,
          price: item.price,
          specialInstructions: ''
        })),
        subtotal: subtotal,
        deliveryFee: deliveryFee,
        tax: 0,
        total: total,
        specialInstructions: formData.get('comment') || '',
        orderType: 'delivery',
        paymentMethod: 'card',
        status: 'pending'
      };

      try {
        console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', orderData);

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        const response = await fetch(`${API_BASE_URL}/orders`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(orderData)
        });

        if (response.ok) {
          const result = await response.json();
          const orderNumber = result.id || result.orderNumber || ('ORD-' + Date.now());

          console.log('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω:', result);

          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
          document.getElementById('checkoutModal').classList.remove('active');
          document.getElementById('orderNumber').textContent = `–ó–∞–∫–∞–∑ #${orderNumber}`;
          document.getElementById('successModal').classList.add('active');

          // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
          cart = [];
          updateCartBadge();
          event.target.reset();
        } else {
          throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status}`);
        }
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞:', error);

        // –í —Ä–µ–∂–∏–º–µ fallback —Å–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑ –ª–æ–∫–∞–ª—å–Ω–æ
        const orderNumber = 'ORD-' + Date.now();
        console.log('Fallback: –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ', orderNumber);

        document.getElementById('checkoutModal').classList.remove('active');
        document.getElementById('orderNumber').textContent = `–ó–∞–∫–∞–∑ #${orderNumber}`;
        document.getElementById('successModal').classList.add('active');

        cart = [];
        updateCartBadge();
        event.target.reset();
      }
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–∫–Ω–∞
    function closeSuccess() {
      document.getElementById('successModal').classList.remove('active');
    }

    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    function showNotification(message) {
      // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ toast)
      console.log('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:', message);
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–≤ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
    document.getElementById('cartModal').addEventListener('click', (e) => {
      if (e.target.id === 'cartModal') closeCart();
    });

    document.getElementById('checkoutModal').addEventListener('click', (e) => {
      if (e.target.id === 'checkoutModal') {
        document.getElementById('checkoutModal').classList.remove('active');
      }
    });
  </script>
</body>
</html>
